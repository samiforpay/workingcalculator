import type { Formula } from '@/config/formulas/types'































interface HomeAffordabilityResult extends Record<string, number> {















  affordableHomePrice: number















  maxMonthlyPayment: number















  downPaymentNeeded: number















  estimatedPropertyTax: number















  estimatedInsurance: number















  debtToIncomeRatio: number















  [key: string]: number















}































// Make rates and limits configurable for easy updates















const HOME_AFFORDABILITY_CONFIG = {















  year: 2023,















  defaults: {















    annualIncome: 75000,















    monthlyDebts: 1000,















    interestRate: 6.5,















    loanTerm: 30,















    downPaymentPercent: 20















  },















  limits: {















    maxIncome: 100000000000, // 100 billion















    maxDebts: 1000000000,    // 1 billion















    maxRate: 25,             // 25% interest rate















    maxTerm: 40              // 40 years















  },















  ratios: {















    frontEndDTI: 0.28,   // Housing costs should not exceed 28% of income















    backEndDTI: 0.36,    // Total debt payments should not exceed 36% of income















    propertyTaxRate: 0.012, // 1.2% annual property tax rate















    insuranceRate: 0.0035  // 0.35% annual insurance rate















  }















}































export const homeAffordabilityCalculator: Formula<HomeAffordabilityResult> = {















  name: 'Home Affordability Calculator',















  description: '',















  longDescription: `















<p>Find out how much house you can afford with our Home Affordability Calculator. This affordable home price calculator takes into account your income, debts, and down payment to provide a clear estimate of the home price range that fits your budget. Ideal for first-time homebuyers, this home affordability estimator guides you in making informed decisions about your future home purchase.</p>















<p>Factors considered:</p>















<ul>















  <li>Income and debt ratios</li>















  <li>Down payment amount</li>















  <li>Property taxes and insurance</li>















  <li>Monthly debt obligations</li>















  <li>Interest rates and loan terms</li>















</ul>















<p>Make informed decisions about your home purchase by understanding your price range and monthly payment capabilities.</p>















`,















  variables: {















    annualIncome: {















      label: 'Annual Income',















      type: 'currency',















      defaultValue: HOME_AFFORDABILITY_CONFIG.defaults.annualIncome,















      min: 0,















      max: HOME_AFFORDABILITY_CONFIG.limits.maxIncome,















      helpText: 'Your total annual household income before taxes'















    },















    monthlyDebts: {















      label: 'Monthly Debt Payments',















      type: 'currency',















      defaultValue: HOME_AFFORDABILITY_CONFIG.defaults.monthlyDebts,















      min: 0,















      max: HOME_AFFORDABILITY_CONFIG.limits.maxDebts,















      helpText: 'Total monthly payments for car loans, credit cards, etc.'















    },















    interestRate: {















      label: 'Mortgage Interest Rate (%)',















      type: 'percentage',
















      defaultValue: HOME_AFFORDABILITY_CONFIG.defaults.interestRate,















      min: 0.1,















      max: HOME_AFFORDABILITY_CONFIG.limits.maxRate,















      helpText: 'Annual mortgage interest rate'















    },















    loanTerm: {















      label: 'Loan Term (Years)',















      type: 'number',
















      defaultValue: HOME_AFFORDABILITY_CONFIG.defaults.loanTerm,















      min: 5,















      max: HOME_AFFORDABILITY_CONFIG.limits.maxTerm,















      step: 5,















      helpText: 'Length of mortgage loan in years'















    },















    downPaymentPercent: {















      label: 'Down Payment (%)',















      type: 'percentage',















      defaultValue: HOME_AFFORDABILITY_CONFIG.defaults.downPaymentPercent,















      min: 3,















      max: 100,















      step: 1,















      helpText: 'Percentage of home price as down payment'















    }















  },















  calculate: (inputs) => {















    const {















      annualIncome,















      monthlyDebts,















      interestRate,















      loanTerm,















      downPaymentPercent















    } = inputs































    // Calculate monthly income















    const monthlyIncome = annualIncome / 12































    // Calculate maximum monthly payment based on front-end ratio















    const maxMonthlyPayment = monthlyIncome * HOME_AFFORDABILITY_CONFIG.ratios.frontEndDTI































    // Calculate maximum total debt payment based on back-end ratio















    const maxTotalDebtPayment = monthlyIncome * HOME_AFFORDABILITY_CONFIG.ratios.backEndDTI















    const availableForHousing = maxTotalDebtPayment - monthlyDebts































    // Use the lower of the two payment limits















    const maxAllowedPayment = Math.min(maxMonthlyPayment, availableForHousing)































    // Calculate monthly mortgage rate















    const monthlyRate = (interestRate / 100) / 12















    const totalPayments = loanTerm * 12































    // Calculate affordable loan amount using mortgage payment formula















    const loanAmount = maxAllowedPayment * 















      ((1 - Math.pow(1 + monthlyRate, -totalPayments)) / monthlyRate)































    // Calculate total affordable home price including down payment















    const affordableHomePrice = loanAmount / (1 - (downPaymentPercent / 100))































    // Calculate other costs















    const downPaymentNeeded = affordableHomePrice * (downPaymentPercent / 100)















    const estimatedPropertyTax = affordableHomePrice * HOME_AFFORDABILITY_CONFIG.ratios.propertyTaxRate / 12















    const estimatedInsurance = affordableHomePrice * HOME_AFFORDABILITY_CONFIG.ratios.insuranceRate / 12































    // Calculate debt-to-income ratio















    const debtToIncomeRatio = ((monthlyDebts + maxAllowedPayment) / monthlyIncome) * 100































    return {















      affordableHomePrice,















      maxMonthlyPayment,















      downPaymentNeeded,















      estimatedPropertyTax,















      estimatedInsurance,















      debtToIncomeRatio,















      loanAmount,















      monthlyIncome,















      totalHousingPayment: maxAllowedPayment + estimatedPropertyTax + estimatedInsurance















    }















  },















  formatResult: (result) => {















    const formatter = new Intl.NumberFormat('en-US', { 















      style: 'currency', 















      currency: 'USD',















      maximumFractionDigits: 0















    })































    return `















Home Affordability Analysis:















-------------------------















Maximum Home Price: ${formatter.format(result.affordableHomePrice)}















Required Down Payment: ${formatter.format(result.downPaymentNeeded)}















Loan Amount: ${formatter.format(result.loanAmount)}































Monthly Payments:















--------------















Principal & Interest: ${formatter.format(result.maxMonthlyPayment)}















Property Tax: ${formatter.format(result.estimatedPropertyTax)}















Insurance: ${formatter.format(result.estimatedInsurance)}















Total Payment: ${formatter.format(result.totalHousingPayment)}































Debt Analysis:















-----------















Monthly Income: ${formatter.format(result.monthlyIncome)}















Debt-to-Income Ratio: ${result.debtToIncomeRatio.toFixed(1)}%































Note: This is an estimate based on standard lending guidelines.















Actual loan approval depends on credit score, employment history,















and other factors. Consider consulting with a mortgage professional.















    `.trim()















  }















} 














